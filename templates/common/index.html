{% extends 'common/base.html' %}
{% load static %}

{% block content %}
    <div class="top-logo">
        <img src="{% static 'images/grass.png' %}" alt="Main Logo">
    </div>

    <main class="content-wrapper-outer">
        <h1 class="news-heading">ПОСЛЕДНИ НОВИНИ</h1>
        <div class="content-wrapper">
            {% if articles %}
                <section class="main-article" id="mainArticle">
                    <a href="{% url 'article-detail' slug=articles.0.slug %}">
                        <h2>{{ articles.0.title|truncatewords:5 }}</h2>
                        <p class="article-des">{{ articles.0.description|truncatewords:50 }}</p>
                        <img src="{{ articles.0.imageURL }}" alt="{{ articles.0.title }}" class="main-image">
                    </a>
                </section>

                {% if articles|length > 1 %}
                <aside class="sidebar">
                    {% for article in articles|slice:"1:3" %}
                    <a href="{% url 'article-detail' slug=article.slug %}">
                        <div class="small-article"
                             data-title="{{ article.title }}"
                             data-description="{{ article.description }}">
                            <h2>{{ article.title|truncatewords:3 }}</h2>
                            <p>{{ article.description|truncatewords:5 }}</p>
                            <img src="{{ article.imageURL }}" alt="{{ article.title }}" class="sidebar-image">
                        </div>
                    </a>
                    {% endfor %}
                </aside>
                {% endif %}
            {% else %}
                <p class="nota">Няма налични статии.</p>
            {% endif %}
        </div>

        {% if articles|length > 3 %}
        <div class="extra-articles">
            {% for article in articles|slice:"3:5" %}
            <a href="{% url 'article-detail' slug=article.slug %}">
                <div class="extra-article" data-title="{{ article.title }}" data-description="{{ article.description }}">
                    <img src="{{ article.imageURL }}" alt="{{ article.title }}" class="extra-image">
                    <div class="extra-text">
                        <h2>{{ article.title }}</h2>
                        <p class="article-des">{{ article.description|truncatewords:25 }}</p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
        {% endif %}
        {% if grouped_matches %}
        <div class="custom-matches-section">
            <h1 class="custom-matches-heading">МАЧОВЕ</h1>
            {% for league, matches in grouped_matches.items %}
            <div class="custom-league-block">
                <h2 class="custom-league-name">{{ league }}</h2>
                <ul class="custom-matches-list">
                    {% for match in matches %}
                    <a href="{% url 'match' match.slug %}" class="custom-match-card-link">
                        <li class="custom-match-card">
                            <div class="custom-match-date">{{ match.date|date:"d.m.Y" }}</div>
                            <div class="custom-match-teams">
                                <div class="custom-team custom-home">
                                    <img src="{{ match.home_team.logo }}" alt="{{ match.home_team.name }}" class="custom-mini-logo">
                                    <span>{{ match.home_team.name }}</span>
                                </div>
                                <div class="custom-match-time">{{ match.date|date:"H:i" }}</div>
                                <div class="custom-team custom-away">
                                    <span>{{ match.away_team.name }}</span>
                                    <img src="{{ match.away_team.logo }}" alt="{{ match.away_team.name }}" class="custom-mini-logo">
                                </div>
                            </div>
                        </li>
                    </a>
                    {% endfor %}
                </ul>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </main>
{% endblock %}
